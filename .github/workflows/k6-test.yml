name: ci-test

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  k6_load_test:
    name: k6 Load Test
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v1

    - name: Run cloud k6 test
      uses: grafana/k6-action@v0.2.0
      with:
        filename: concreteAI.js
        cloud: true
        token: 5958842b15300563ac572bf8d5671f2d755d9aefb8b4440f6d5d6fced72887cb

    - name: Upload performance test results
      uses: actions/upload-artifact@v3
      with:
        name: k6-report
        path: k6TestingOutput.json
